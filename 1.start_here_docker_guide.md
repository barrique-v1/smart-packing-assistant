# Docker Deployment Guide

This guide explains how to build and run the Smart Packing Assistant using Docker and Docker Compose.

## Prerequisites

- Docker Desktop (Windows/Mac) or Docker Engine (Linux)
- Docker Compose
- OpenAI API Key
- Python 3.9+ (for Qdrant import script)

## Quick Start

### 1. Set up environment variables

Edit the `.env` file in the project root and add your OpenAI API key:

```bash
# .env
OPENAI_API_KEY=sk-your-actual-openai-api-key-here
POSTGRES_DB=NAME
POSTGRES_USER=USER
POSTGRES_PASSWORD=PASSWORD
```

**Important**: The `.env.example` file is provided as a template. Copy it to `.env` and replace `sk-your-actual-openai-api-key-here` with your actual OpenAI API key.

### 2. Build all services

```bash
docker compose build
```

This will build:
- `postgres` (PostgreSQL 15 database)
- `qdrant` (Qdrant vector database for RAG)
- `ai-worker` (AI Worker service on port 8081)
- `api-gateway` (API Gateway service on port 8080)
- `frontend` (React frontend on port 5173)

**Note**: The first build will take 10-15 minutes as it downloads dependencies and compiles the Kotlin code.

### 3. Start all services

```bash
docker compose up -d
```

### 4. Generate RAG Knowledge Base Embeddings

**Install Python dependencies**:
```bash
pip3 install openai tqdm requests
```

**Generate embeddings** (creates vector representations of 140 packing items):
```bash
python3 scripts/generate-embeddings.py
```

The script automatically reads your OpenAI API key from the `.env` file - no manual export needed!

### 5. Import RAG Knowledge Base to Qdrant

**Import embeddings to Qdrant**:
```bash
python3 scripts/import-to-qdrant.py --recreate
```

**Note**: These steps are required for RAG-enhanced packing list generation. Without them, the AI Worker will fall back to pure GPT generation (which still works but is less accurate).

### 6. Access the frontend

Open your browser and navigate to:

http://localhost:5173

### Happy packing! :)

Other service health check endpoints:
- API Gateway: http://localhost:8080/api/packing/health
- AI Worker: http://localhost:8081/api/ai/health
- Qdrant Dashboard: http://localhost:6333/dashboard

## Next Steps

After Docker is working:
- Deploy to Kubernetes (see `k8s/` directory)
